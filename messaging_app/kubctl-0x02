#!/bin/bash

# kubctl-0x02
# Script to deploy Blue and Green versions, then check logs for errors

set -e

echo "ğŸ“¦ Deploying Blue version..."
kubectl apply -f blue_deployment.yaml

echo "ğŸ“¦ Deploying Green version..."
kubectl apply -f green_deployment.yaml

echo "ğŸ” Checking logs for Green version pods..."
GREEN_PODS=$(kubectl get pods -l app=messaging-app,version=green -o jsonpath='{.items[*].metadata.name}')

for POD in $GREEN_PODS; do
    echo "ğŸ“œ Logs for $POD:"
    kubectl logs $POD || echo "âš ï¸ No logs found for $POD"
done

echo "âœ… Blue-Green deployment setup complete."
echo "â„¹ï¸ To switch traffic to green version, edit 'kubeservice.yaml' selector to 'version: green' and apply it:"
echo "kubectl apply -f kubeservice.yaml"
